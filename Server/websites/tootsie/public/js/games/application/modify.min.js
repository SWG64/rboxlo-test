function hookUpDataListEvents(){console.log("[rboxlo->info]: modify::hookUpDataListEvents"),$(".delete-application").each(function(){$(this).on("click",()=>{deleteApplicationModal($(this).parent().parent().attr("data-rboxlo-application-id"))})}),$(".data-uuid-copy").each(function(){$(this).on("click",()=>{copy($(this).parent().find(".data-uuid").text())})}),$(".data-lastDeployedVersionUUID-copy").each(function(){$(this).attr("disabled")||$(this).on("click",()=>{copy($(this).parent().find(".data-uuid").text())})}),$(".data-internalName-copy").each(function(){$(this).on("click",()=>{copy($(this).parent().find(".data-internalName").text())})})}function populate(e=!1){console.log(`[rboxlo->info]: modify::data | fetching data (initializing: ${e?"TRUE":"FALSE"})`),e||($("#data").addClass("d-none"),$("#data-loading").removeClass("d-none"));let a=$("#data-body");a.html(""),$("#data-empty").hasClass("d-none")||$("#data-empty").addClass("d-none"),fetch(url("/api/games/application/json")).then(e=>e.json()).then(e=>{0==e.length?($("#data-loading").addClass("d-none"),$("#data-empty").removeClass("d-none")):($(e).each(function(){let e=$("<tr>",{"data-rboxlo-application-id":this.id}),t=$("<td>",{class:"align-middle text-center table-button",scope:"row"}).append($("<a>",{href:url(`/games/application/modify?id=${this.id}`)}).append($("<button>",{class:"btn btn-primary btn-sm",type:"button"}).append($("<i>",{class:"fas fa-pencil"})))),n=$("<td>",{class:"align-middle text-center table-button",scope:"row"}).append($("<button>",{class:"btn btn-danger btn-sm delete-application",type:"button"}).append($("<i>",{class:"fas fa-trash"}))),s=$("<td>",{class:"align-middle text-center table-button",scope:"row"}).append($("<a>",{class:"btn btn-success btn-sm text-white",type:"button",href:url(`/games/application/deployment?id=${this.id}`)}).append($("<i>",{class:"fas fa-upload"}))),l=$("<td>",{class:"align-middle text-center"}).append(this.id),d=$("<td>",{class:"align-middle"}).append(this.displayName),o=$("<td>",{class:"align-middle"}).append($("<div>",{class:"d-flex justify-content-between align-items-center"}).append([$("<code>",{class:"data-internalName"}).append(this.internalName),$("<button>",{class:"btn btn-secondary btn-sm data-internalName-copy"}).append($("<i>",{class:"fas fa-clipboard"}))])),i=$("<td>",{class:"align-middle"}).append($("<div>",{class:"d-flex justify-content-between align-items-center"}).append([$("<code>",{class:"data-uuid"}).append(this.uuid),$("<button>",{class:"btn btn-secondary btn-sm data-uuid-copy"}).append($("<i>",{class:"fas fa-clipboard"}))])),p=$("<td>",{class:"align-middle"});this.lastDeployedVersionUUID.length>0?p.append($("<div>",{class:"d-flex justify-content-between align-items-center"}).append([$("<code>",{class:"data-lastDeployedVersionUUID"}).append(this.lastDeployedVersionUUID),$("<button>",{class:"btn btn-secondary btn-sm data-lastDeployedVersionUUID-copy"}).append($("<i>",{class:"fas fa-clipboard"}))])):p.append($("<div>",{class:"d-flex justify-content-between align-items-center"}).append([$("<i>",{class:"text-muted"}).append("none"),$("<button>",{class:"btn btn-secondary btn-sm",disabled:""}).append($("<i>",{class:"fas fa-clipboard"}))]));let c=$("<td>",{class:"align-middle"}).append(timestamp(this.lastUpdatedTimestamp)),r=$("<td>",{class:"align-middle"}).append(timestamp(this.createdTimestamp));e.append(t),e.append(n),e.append(s),e.append(l),e.append(d),e.append(o),e.append(i),e.append(p),e.append(c),e.append(r),a.append(e)}),hookUpDataListEvents(),setTimeout(()=>{$("#data-loading").addClass("d-none"),$("#data").removeClass("d-none")},200))})}function regenerateUUID(){let e=$("#regenerate-uuid-spinner");e.removeClass("d-none");let a=$('meta[name="rboxlo-application-id"]').attr("content"),t=$('meta[name="rboxlo-csrf"]').attr("content");fetch(url("/api/games/application/uuid"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({_csrf:t,id:a,method:"regenerate"})}).then(e=>e.json()).then(a=>{e.addClass("d-none");let t=$("#update");a.success?(t.hasClass("alert-danger")&&(t.removeClass("alert-danger"),t.addClass("alert-success")),t.text("Successfully regenerated application UUID!"),t.removeClass("d-none"),t.removeAttr("style"),$("#uuid").text(a.new),$("#last-updated").text(timestamp(moment().unix()))):(t.hasClass("alert-success")&&(t.removeClass("alert-success"),t.addClass("alert-danger")),t.text("Unknown error occurred"),t.removeClass("d-none"),t.removeAttr("style")),setTimeout(()=>{update.fadeOut("slow")},2250)})}function displayNameSubmit(){console.log("[rboxlo->info]: modify::displayNameSubmit");let e=$("#display-name-spinner"),a=$("#display-name-update");e.removeClass("d-none"),a.hasClass("d-none")||a.addClass("d-none");let t=$('meta[name="rboxlo-application-id"]').attr("content"),n=$('meta[name="rboxlo-csrf"]').attr("content"),s=$("#display-name-input"),l=$("#display-name-modal"),d=$("#update"),o=s.val();if(0==o.length)return a.hasClass("alert-success")&&(a.removeClass("alert-success"),a.addClass("alert-danger")),a.text("The new display name must not be empty."),void a.removeClass("d-none");fetch(url("/api/games/application/set"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({_csrf:n,id:t,column:"display_name",value:o})}).then(e=>e.json()).then(t=>{if(e.addClass("d-none"),t.success){d.hasClass("alert-danger")&&(d.removeClass("alert-danger"),d.addClass("alert-success")),d.text("Successfully updated display name!"),d.removeClass("d-none"),d.removeAttr("style"),s.val("");for(let e=0;e<$(".display-name").length;e++)$(".display-name").eq(e).text(o);$("#last-updated").text(timestamp(moment().unix())),setTimeout(()=>{d.fadeOut("slow")},2250),l.modal("toggle")}else a.hasClass("alert-success")&&(a.removeClass("alert-success"),a.addClass("alert-danger")),a.text("Unknown error occurred"),a.removeClass("d-none")})}function internalNameSubmit(){console.log("[rboxlo->info]: modify::internalNameSubmit");let e=$("#internal-name-spinner"),a=$("#internal-name-update");e.removeClass("d-none"),a.hasClass("d-none")||a.addClass("d-none");let t=$('meta[name="rboxlo-application-id"]').attr("content"),n=$('meta[name="rboxlo-csrf"]').attr("content"),s=$("#internal-name-input"),l=$("#internal-name-modal"),d=$("#update"),o=s.val();if(0==o.length)return a.hasClass("alert-success")&&(a.removeClass("alert-success"),a.addClass("alert-danger")),a.text("The new internal name must not be empty."),void a.removeClass("d-none");fetch(url("/api/games/application/set"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({_csrf:n,id:t,column:"internal_name",value:o})}).then(e=>e.json()).then(t=>{if(e.addClass("d-none"),t.success){d.hasClass("alert-danger")&&(d.removeClass("alert-danger"),d.addClass("alert-success")),d.text("Successfully updated internal name!"),d.removeClass("d-none"),d.removeAttr("style"),s.val("");for(let e=0;e<$(".internal-name").length;e++)$(".internal-name").eq(e).text(o);$("#last-updated").text(timestamp(moment().unix())),setTimeout(()=>{d.fadeOut("slow")},2250),l.modal("toggle")}else a.hasClass("alert-success")&&(a.removeClass("alert-success"),a.addClass("alert-danger")),a.text("Unknown error occurred"),a.removeClass("d-none")})}function deleteApplicationModal(e){$("#delete-application-submit").off("click").on("click",()=>{deleteApplication(e)}),$("#delete-application-modal").modal("show")}function deleteApplication(e,a=!1){console.log(`[rboxlo->info]: modify::deleteApplication | deleting application with ID ${e}`);let t=$('meta[name="rboxlo-csrf"]').attr("content"),n=$("#delete-spinner");n.removeClass("d-none"),fetch(url("/api/games/application/delete"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({_csrf:t,id:e})}).then(e=>e.json()).then(e=>{let t=$("#update");if(e.success){if(a)return void(window.location.href=url("/games/application/modify"));t.text(`Successfully deleted application "${e.deleted.displayName}"!`),t.removeClass("d-none"),t.removeAttr("style"),n.addClass("d-none"),$("#delete-application-modal").modal("hide"),populate(),setTimeout(()=>{t.fadeOut("slow")},2250)}})}$(document).ready(()=>{$("#data").length?($("#data-refresh").on("click",()=>{populate()}),populate(!0)):($("#regenerate-uuid").click(()=>{regenerateUUID()}),$("#display-name-submit").click(()=>{displayNameSubmit()}),$("#internal-name-submit").click(()=>{internalNameSubmit()}),$("#delete-application-submit").click(()=>{deleteApplication($('meta[name="rboxlo-application-id"]').attr("content"),!0)}))});